<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Warsaw Golden Mile ‚Äì Interactive Map</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <!-- Leaflet core + Routing Machine CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="anonymous" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine@3.2.12/dist/leaflet-routing-machine.css" integrity="sha256-c9P8YhpNigK4SU9XW+0BYsaEJxO52A9P3PYc4dRLtzE=" crossorigin="anonymous" />

  <style>
    html,body{margin:0;padding:0;height:100%;font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif}
    #map{height:100%;width:100%}

    /* numbered circle marker */
    .marker-num{display:flex;align-items:center;justify-content:center;width:28px;height:28px;border-radius:50%;background:#ff6b00;color:#fff;font-weight:700;font-size:.8rem;border:2px solid #fff;box-shadow:0 0 4px rgba(0,0,0,.4)}

    /* floating panels */
    .panel{position:absolute;z-index:1000;background:#fff;padding:10px 12px;border-radius:12px;box-shadow:0 3px 8px rgba(0,0,0,.22);font-size:.85rem;line-height:1.35;overflow-y:auto;max-height:380px;width:280px}
    .panel h4{margin:0 0 6px;font-size:1rem}
    .legend{bottom:10px;right:10px}
    .itinerary{top:10px;right:10px}
    .recs{top:60px;left:10px;width:300px}
    .recs ol{list-style:none;padding:0;margin:0}
    .recs li{background:#f7f7f7;border-radius:8px;margin:0 0 6px;padding:8px 10px;cursor:pointer;transition:background .2s}
    .recs li:hover{background:#ffe8d9}
    .recs hr{border:0;border-top:1px dashed #ccc;margin:10px 0 8px}
    .recs ul{padding-left:18px;margin:0}

    /* mobile FABs */
    .fab{position:absolute;left:10px;width:46px;height:46px;border-radius:50%;background:#ff6b00;color:#fff;display:flex;align-items:center;justify-content:center;font-size:1.3rem;box-shadow:0 2px 6px rgba(0,0,0,.3);z-index:1100;cursor:pointer;user-select:none;transition:transform .15s}
    .fab:active{transform:scale(.9)}
    .fab-legend{bottom:174px}
    .fab-itinerary{bottom:118px}
    .fab-recs{bottom:62px}

    @media(max-width:600px){
      .panel{width:90vw;max-height:50vh;display:none;font-size:.94rem}
      .marker-num{width:24px;height:24px;font-size:.7rem}
    }
  </style>

  <!-- Leaflet core + Routing Machine JS -->
  <script defer src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin="anonymous"></script>
  <script defer src="https://unpkg.com/leaflet-routing-machine@3.2.12/dist/leaflet-routing-machine.js" integrity="sha256-aUaz2YsmiVjCwXTlzAIXazhbugzuDUFcPRl1BDpRP70=" crossorigin="anonymous"></script>
</head>
<body>
  <div id="map"></div>

  <script>
  window.addEventListener('DOMContentLoaded',()=>{
    /* === Data === */
    const bars=[
      {n:1,name:"PINTA Warszawa",addr:"Chmielna 7/9",coords:[52.23236,21.00972],time:"17:00‚Äì17:40",beer:"Atak Chmielu IPA",food:"–∫—É–±–∞–Ω–æ—Å –∏–ª–∏ —Ä—ã–±–Ω—ã–π —Ç–æ—Å—Ç"},
      {n:2,name:"Hoppiness Beer & Food",addr:"Chmielna 27/31",coords:[52.22925,21.01389],time:"17:45‚Äì18:25",beer:"Artezan NZ West Coast IPA",food:"Hoppiness Burger"},
      {n:3,name:"BrewDog Warszawa",addr:"Widok 8",coords:[52.23245,21.01105],time:"18:30‚Äì19:10",beer:"Punk IPA",food:"Buffalo Wings"},
      {n:4,name:"GorƒÖczka Z≈Çota",addr:"Wilcza 29",coords:[52.22538,21.013],time:"19:15‚Äì19:55",beer:"Komes Porter Baltic",food:"—Ç–∞—Ç–∞—Ä—Å–∫–∏–π –±–∏—Ñ—à—Ç–µ–∫—Å"},
      {n:5,name:"Hopito Parkingowa",addr:"≈ªurawia 32/34",coords:[52.22546,21.01759],time:"20:00‚Äì20:40",beer:"NEIPA Tropic Vortex",food:"street‚Äëfood tacos"},
      {n:6,name:"Jabeerwocky",addr:"Nowogrodzka 12",coords:[52.22852,21.01066],time:"20:45‚Äì21:25",beer:"Collab DDH DIPA",food:"–∫—Ä—ç–Ω—Ü–µ–ª—å —Å –≥–æ—Ä—á–∏—Ü–µ–π"},
      {n:7,name:"Kufle i Kapsle",addr:"Nowogrodzka 25",coords:[52.2285,21.0072],time:"21:30‚Äì22:10",beer:"Smoky Joe Peated Stout",food:"—Å–∏–ª–µ–∑—Å–∫–∞—è –∫–æ–ª–±–∞—Å–∫–∞"},
      {n:8,name:"PiwPaw Beer Heaven",addr:"Foksal 16",coords:[52.23603,21.02055],time:"22:15‚Äì22:55",beer:"Gose ‚ÄòHokus¬†Pokus‚Äô",food:"nachos & —Å—ã—Ä–Ω—ã–π –¥–∏–ø"},
      {n:9,name:"The Alchemist Gastropub",addr:"pl. Pi≈Çsudskiego 3",coords:[52.24038,21.01144],time:"23:00‚Äì23:40",beer:"Self‚Äëpour Pilsner",food:"flatbread"},
      {n:10,name:"Same Krafty",addr:"Nowomiejska 10",coords:[52.24909,21.01184],time:"23:50‚Äì00:25",beer:"Local Saison",food:"–±—É—Ä—Ä–∞—Ç–∞‚Äë–ø–∏—Ü—Ü–∞"},
      {n:11,name:"Cze≈õƒá!",addr:"Grzybowska 2",coords:[52.23666,21.00479],time:"00:35‚Äì01:05",beer:"SALSA Sour Ale",food:"–ø–∞–Ω–∏–Ω–∏"},
      {n:12,name:"Drugie Dno",addr:"Nowogrodzka 4",coords:[52.22928,21.01211],time:"01:15‚Äì‚è∞",beer:"Barrel‚Äëaged Imperial Stout",food:"—Å—ã—Ä–Ω–∞—è –¥–æ—Å–∫–∞"}
    ];

    const snacks=["Pretzel platter","Charcuterie board","Nachos grande","15 buffalo wings","Polish tapas set"];
    const tips=["–ü–µ–π—Ç–µ 0,3¬†–ª –∏ –≤–æ–¥—É","–ú–∞—Ä—à—Ä—É—Ç –ø–µ—à–∫–æ–º","–ó–∞–ø–∞—Å–Ω–æ–π –±–∞—Ä ‚Äì Alchemist","–§–æ—Ç–æ —Å –≤—ã–≤–µ—Å–∫–∞–º–∏ = –±–æ–Ω—É—Å"];
    const gLink=b=>`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(b.name+", "+b.addr+", Warsaw")}`;

    /* === Safety: libs === */
    if(typeof L==='undefined' || typeof L.Routing==='undefined'){
      document.body.textContent='‚ö†Ô∏è Leaflet libraries failed to load.';return;
    }

    /* === Map init === */
    const map=L.map('map');
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{
      maxZoom:19,
      attribution:'¬© OpenStreetMap'
    }).addTo(map);

    /* === Markers === */
    const markers={};
    bars.forEach(b=>{
      const icon=L.divIcon({html:`<span class='marker-num'>${b.n}</span>`,className:''});
      const m=L.marker(b.coords,{icon}).addTo(map)
        .bindPopup(`<strong>${b.n}. <a href='${gLink(b)}' target='_blank' rel='noopener'>${b.name}</a></strong><br>${b.addr}<br><em>${b.time}</em><br>üç∫ ${b.beer}<br>üçΩÔ∏è ${b.food}`);
      markers[b.n]=m;
    });

    /* === Route === */
    const waypoints=bars.map(b=>L.latLng(...b.coords));
    const routing=L.Routing.control({
      waypoints,
      router:L.Routing.osrmv1({serviceUrl:'https://router.project-osrm.org/route/v1',profile:'foot'}),
      addWaypoints:false,
      draggableWaypoints:false,
      fitSelectedRoutes:false,
      lineOptions:{styles:[{color:'#ff6b00',weight:4,opacity:.9}]},
      createMarker:()=>null,
      show:false
    }).addTo(map);

    routing.on('routesfound',e=>map.fitBounds(e.routes[0].bounds,{padding:[20,20]}));
    routing.on('routingerror',()=>{
      L.polyline(bars.map(b=>b.coords),{color:'#ff6b00',dashArray:'6 4'}).addTo(map);
      map.fitBounds(bars.map(b=>b.coords),{padding:[20,20]});
    });

    /* === Panel helper === */
    function addPanel(cls,html){
      const d=document.createElement('div');
      d.className=`panel ${cls}`;
      d.innerHTML=html;
      document.body.appendChild(d);
      L.DomEvent.disableClickPropagation(d);
      L.DomEvent.disableScrollPropagation(d);
      return d;
    }

    /* === Panels === */
    const pLegend=addPanel('legend',`<h4>Legend</h4><ol>${bars.map(b=>`<li><b>${b.n}</b> <a href='${gLink(b)}' target='_blank' rel='noopener'>${b.name}</a></li>`).join('')}</ol>`);
    const pItin=addPanel('itinerary',`<h4>–ú–∞—Ä—à—Ä—É—Ç</h4><ol>${bars.map(b=>`<li><b>${b.time}</b> ‚Äì <a href='${gLink(b)}' target='_blank' rel='noopener'>${b.name}</a></li>`).join('')}</ol>`);
    const pRecs=addPanel('recs',`<h4>–ß—Ç–æ –∑–∞–∫–∞–∑–∞—Ç—å</h4><ol>${bars.map(b=>`<li data-n='${b.n}'>üç∫ ${b.beer}<br>üçΩÔ∏è ${b.food}</li>`).join('')}</ol><hr><h4>üçü Snacks for 3</h4><ul>${snacks.map(s=>`<li>${s}</li>`).join('')}</ul><hr><h4>üöÄ –°–æ–≤–µ—Ç—ã</h4><ul>${tips.map(t=>`<li>${t}</li>`).join('')}</ul>`);

    /* === Recs click => focus === */
    pRecs.addEventListener('click',e=>{
      const li=e.target.closest('li[data-n]');
      if(!li) return;
      const n=parseInt(li.dataset.n,10);
      const m=markers[n];
      if(m){
        map.setView(m.getLatLng(),16,{animate:true});
        m.openPopup();
      }
    });

    /* === FABs for mobile === */
    if(window.innerWidth<=600){
      [pLegend,pItin,pRecs].forEach(p=>p.style.display='none');
      const makeFab=(cls,label,panel)=>{
        const f=document.createElement('div');
        f.className=`fab ${cls}`;
        f.textContent=label;
        f.onclick=()=>panel.style.display=panel.style.display==='none'?'block':'none';
        document.body.appendChild(f);
      };
      makeFab('fab-legend','‚Ñπ',pLegend);
      makeFab('fab-itinerary','‚è∞',pItin);
      makeFab('fab-re
